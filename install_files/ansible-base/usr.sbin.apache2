# Last Modified: Mon Oct 20 20:56:06 2014
#include <tunables/global>

/usr/sbin/apache2 flags=(complain) {
  #include <abstractions/base>
  #include <abstractions/tor>

  capability dac_override,
  capability kill,
  capability net_bind_service,

  /bin/dash rix,
  /etc/apache2/apache2.conf r,
  /etc/apache2/conf-available/charset.conf r,
  /etc/apache2/conf-available/localized-error-pages.conf r,
  /etc/apache2/conf-available/other-vhosts-access-log.conf r,
  /etc/apache2/conf-available/security.conf r,
  /etc/apache2/conf-available/serve-cgi-bin.conf r,
  /etc/apache2/conf-enabled/ r,
  /etc/apache2/mods-available/access_compat.load r,
  /etc/apache2/mods-available/alias.conf r,
  /etc/apache2/mods-available/alias.load r,
  /etc/apache2/mods-available/auth_basic.load r,
  /etc/apache2/mods-available/authn_core.load r,
  /etc/apache2/mods-available/authn_file.load r,
  /etc/apache2/mods-available/authz_core.load r,
  /etc/apache2/mods-available/authz_host.load r,
  /etc/apache2/mods-available/authz_user.load r,
  /etc/apache2/mods-available/autoindex.conf r,
  /etc/apache2/mods-available/autoindex.load r,
  /etc/apache2/mods-available/deflate.conf r,
  /etc/apache2/mods-available/deflate.load r,
  /etc/apache2/mods-available/dir.conf r,
  /etc/apache2/mods-available/dir.load r,
  /etc/apache2/mods-available/env.load r,
  /etc/apache2/mods-available/filter.load r,
  /etc/apache2/mods-available/headers.load r,
  /etc/apache2/mods-available/mime.conf r,
  /etc/apache2/mods-available/mime.load r,
  /etc/apache2/mods-available/mpm_event.conf r,
  /etc/apache2/mods-available/mpm_event.load r,
  /etc/apache2/mods-available/negotiation.conf r,
  /etc/apache2/mods-available/negotiation.load r,
  /etc/apache2/mods-available/reqtimeout.conf r,
  /etc/apache2/mods-available/reqtimeout.load r,
  /etc/apache2/mods-available/rewrite.load r,
  /etc/apache2/mods-available/setenvif.conf r,
  /etc/apache2/mods-available/setenvif.load r,
  /etc/apache2/mods-available/status.conf r,
  /etc/apache2/mods-available/status.load r,
  /etc/apache2/mods-available/wsgi.conf r,
  /etc/apache2/mods-available/wsgi.load r,
  /etc/apache2/mods-available/xsendfile.load r,
  /etc/apache2/mods-enabled/ r,
  /etc/apache2/ports.conf r,
  /etc/apache2/sites-available/000-default.conf r,
  /etc/apache2/sites-available/document.conf r,
  /etc/apache2/sites-available/source.conf r,
  /etc/apache2/sites-enabled/ r,
  /etc/mime.types r,
  /etc/python2.7/sitecustomize.py r,
  /run/apache2/apache2.pid rw,
  /run/apache2/wsgi.*.lock wk,
  /run/apache2/wsgi.*.sock w,
  /run/lock/apache2/rewrite-map.* w,
  /usr/lib{,32,64}/** mr,
  /usr/local/lib/python2.7/dist-packages/ r,
  /usr/share/pyshared/supervisor-*-nspkg.pth r,
  /var/lib/securedrop/keys/* rw,
  /var/lib/securedrop/keys/pubring.gpg rw,
  /var/lib/securedrop/keys/pubring.gpg.lock rwl,
  /var/lib/securedrop/keys/pubring.gpg.tmp rw,
  /var/lib/securedrop/keys/pubring.gpg~ w,
  /var/lib/securedrop/keys/random_seed rwk,
  /var/lib/securedrop/keys/secring.gpg r,
  /var/lib/securedrop/keys/secring.gpg.lock rw,
  /var/lib/securedrop/keys/secring.gpg.tmp rw,
  /var/lib/securedrop/keys/trustdb.gpg rw,
  /var/lib/securedrop/keys/trustdb.gpg.lock rwl,
  /var/log/apache2/document-access.log w,
  /var/log/apache2/document-error.log w,
  /var/log/apache2/error.log w,
  /var/log/apache2/source-error.log w,
  /var/www/securedrop/ r,
  /var/www/securedrop/store.py r,
  /var/www/securedrop/store.pyc rw,
  /var/www/securedrop/store/** rw,
  /var/www/securedrop/version.py r,
  /var/www/securedrop/version.pyc rw,


  ^DEFAULT_URI flags=(complain) {
  }

  ^HANDLING_UNTRUSTED_INPUT flags=(complain) {
  }
}
